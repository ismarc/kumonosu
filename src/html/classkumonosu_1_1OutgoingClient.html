<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>kumonosu::OutgoingClient Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.5 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="namespacekumonosu.html">kumonosu</a>::<a class="el" href="classkumonosu_1_1OutgoingClient.html">OutgoingClient</a>
  </div>
</div>
<div class="contents">
<h1>kumonosu::OutgoingClient Class Reference</h1><!-- doxytag: class="kumonosu::OutgoingClient" -->Manages remote server connections and processes sending queueItems.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="OutgoingClient_8h-source.html">OutgoingClient.h</a>&gt;</code>
<p>

<p>
<a href="classkumonosu_1_1OutgoingClient-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkumonosu_1_1OutgoingClient.html#28a921574e9fc10a92cc4330292fdc5d">OutgoingClient</a> (<a class="el" href="classkumonosu_1_1RequestQueue.html">RequestQueue</a> *queue)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initializes internal data objects and sets the queue to check.  <a href="#28a921574e9fc10a92cc4330292fdc5d"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkumonosu_1_1OutgoingClient.html#7a9f04e701061bd5e932238a1815c6e1">setOutgoingQueue</a> (<a class="el" href="classkumonosu_1_1RequestQueue.html">RequestQueue</a> *queue)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets the <a class="el" href="classkumonosu_1_1RequestQueue.html" title="Provides management of std::queue&#39;s for multiple destination services.">RequestQueue</a> for outgoing requests.  <a href="#7a9f04e701061bd5e932238a1815c6e1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkumonosu_1_1OutgoingClient.html#af0ac575a942dc4c2eecc8f3891934ac">addServer</a> (int32_t serverId, std::vector&lt; int32_t &gt; serviceIds, std::string serverAddress, int32_t serverPort)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates a remote server connection and adds to the list.  <a href="#af0ac575a942dc4c2eecc8f3891934ac"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkumonosu_1_1OutgoingClient.html#13b863ccf547fc1326c96ee871d15af8">removeServer</a> (int32_t serverId)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Removes a server from the associations.  <a href="#13b863ccf547fc1326c96ee871d15af8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkumonosu_1_1OutgoingClient.html#da2c9009eade4ea095eb4ad7482ee87f">run</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Starts processing of outgoing requests.  <a href="#da2c9009eade4ea095eb4ad7482ee87f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkumonosu_1_1OutgoingClient.html#1a2d55524e5a5d91aed897a2f315ba2c">shutdown</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Stops processing of outgoing requests.  <a href="#1a2d55524e5a5d91aed897a2f315ba2c"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">std::vector&lt; Server &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classkumonosu_1_1OutgoingClient.html#a41f4bc53073db71348badfdf6224b0f">getServerList</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns a list of all servers the client knows about.  <a href="#a41f4bc53073db71348badfdf6224b0f"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Manages remote server connections and processes sending queueItems. 
<p>
<a class="el" href="classkumonosu_1_1OutgoingClient.html" title="Manages remote server connections and processes sending queueItems.">OutgoingClient</a> is a service for processing the actual sending of requests to remote servers. It processes items in the outgoing queue and sends them to the appropriate servers. Items are not processed or sent until <a class="el" href="classkumonosu_1_1OutgoingClient.html#da2c9009eade4ea095eb4ad7482ee87f" title="Starts processing of outgoing requests.">run()</a> is called. Once called, the system will loop over checking for items in the outgoing queue and sending them until <a class="el" href="classkumonosu_1_1OutgoingClient.html#1a2d55524e5a5d91aed897a2f315ba2c" title="Stops processing of outgoing requests.">shutdown()</a> is called. Once <a class="el" href="classkumonosu_1_1OutgoingClient.html#1a2d55524e5a5d91aed897a2f315ba2c" title="Stops processing of outgoing requests.">shutdown()</a> is called, the object is still valid and subsequent calls to <a class="el" href="classkumonosu_1_1OutgoingClient.html#da2c9009eade4ea095eb4ad7482ee87f" title="Starts processing of outgoing requests.">run()</a> will start sending objects again. Note that queueItems destined for a service id of 0 must have a remote server id specified or they will be consumed and discarded.<p>
<dl class="author" compact><dt><b>Author:</b></dt><dd>Matt Brace </dd></dl>

<p>Definition at line <a class="el" href="OutgoingClient_8h-source.html#l00037">37</a> of file <a class="el" href="OutgoingClient_8h-source.html">OutgoingClient.h</a>.</p>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="28a921574e9fc10a92cc4330292fdc5d"></a><!-- doxytag: member="kumonosu::OutgoingClient::OutgoingClient" ref="28a921574e9fc10a92cc4330292fdc5d" args="(RequestQueue *queue)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">OutgoingClient::OutgoingClient           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classkumonosu_1_1RequestQueue.html">RequestQueue</a> *&nbsp;</td>
          <td class="paramname"> <em>queue</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Initializes internal data objects and sets the queue to check. 
<p>
Initializes internal data objects and prepares the system for a call to <a class="el" href="classkumonosu_1_1OutgoingClient.html#da2c9009eade4ea095eb4ad7482ee87f" title="Starts processing of outgoing requests.">run()</a>. Processing does not begin with a call to the constructor. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>queue</em>&nbsp;</td><td>the <a class="el" href="classkumonosu_1_1RequestQueue.html" title="Provides management of std::queue&#39;s for multiple destination services.">RequestQueue</a> object that will contain/contains outgoing requests to process. </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="OutgoingClient_8cpp-source.html#l00005">5</a> of file <a class="el" href="OutgoingClient_8cpp-source.html">OutgoingClient.cpp</a>.</p>

</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="7a9f04e701061bd5e932238a1815c6e1"></a><!-- doxytag: member="kumonosu::OutgoingClient::setOutgoingQueue" ref="7a9f04e701061bd5e932238a1815c6e1" args="(RequestQueue *queue)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void OutgoingClient::setOutgoingQueue           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classkumonosu_1_1RequestQueue.html">RequestQueue</a> *&nbsp;</td>
          <td class="paramname"> <em>queue</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sets the <a class="el" href="classkumonosu_1_1RequestQueue.html" title="Provides management of std::queue&#39;s for multiple destination services.">RequestQueue</a> for outgoing requests. 
<p>
Assigns the specified <a class="el" href="classkumonosu_1_1RequestQueue.html" title="Provides management of std::queue&#39;s for multiple destination services.">RequestQueue</a> for processing outgoing requests. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>queue</em>&nbsp;</td><td>the <a class="el" href="classkumonosu_1_1RequestQueue.html" title="Provides management of std::queue&#39;s for multiple destination services.">RequestQueue</a> to assign. </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="OutgoingClient_8cpp-source.html#l00014">14</a> of file <a class="el" href="OutgoingClient_8cpp-source.html">OutgoingClient.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="af0ac575a942dc4c2eecc8f3891934ac"></a><!-- doxytag: member="kumonosu::OutgoingClient::addServer" ref="af0ac575a942dc4c2eecc8f3891934ac" args="(int32_t serverId, std::vector&lt; int32_t &gt; serviceIds, std::string serverAddress, int32_t serverPort)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void OutgoingClient::addServer           </td>
          <td>(</td>
          <td class="paramtype">int32_t&nbsp;</td>
          <td class="paramname"> <em>serverId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; int32_t &gt;&nbsp;</td>
          <td class="paramname"> <em>serviceIds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&nbsp;</td>
          <td class="paramname"> <em>serverAddress</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&nbsp;</td>
          <td class="paramname"> <em>serverPort</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Creates a remote server connection and adds to the list. 
<p>
Creates a <a class="el" href="classkumonosu_1_1RemoteServer.html" title="Represents a connection to a remote server for sending requests.">RemoteServer</a> object based on supplied parameters and assigns it as a destination for the specified identifiers. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>serverId</em>&nbsp;</td><td>the id to associate with the server for requests with service id 0. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>serviceIds</em>&nbsp;</td><td>a std::vector containing the service ids to associate with the server. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>serverAddress</em>&nbsp;</td><td>the server address for the remote server. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>serverPort</em>&nbsp;</td><td>the server port for the remote server. </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="OutgoingClient_8cpp-source.html#l00020">20</a> of file <a class="el" href="OutgoingClient_8cpp-source.html">OutgoingClient.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="13b863ccf547fc1326c96ee871d15af8"></a><!-- doxytag: member="kumonosu::OutgoingClient::removeServer" ref="13b863ccf547fc1326c96ee871d15af8" args="(int32_t serverId)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void OutgoingClient::removeServer           </td>
          <td>(</td>
          <td class="paramtype">int32_t&nbsp;</td>
          <td class="paramname"> <em>serverId</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Removes a server from the associations. 
<p>
Removes a server from association with the server id and service ids. The server object is then destroyed, closing and freeing the connection. 
<p>Definition at line <a class="el" href="OutgoingClient_8cpp-source.html#l00039">39</a> of file <a class="el" href="OutgoingClient_8cpp-source.html">OutgoingClient.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="da2c9009eade4ea095eb4ad7482ee87f"></a><!-- doxytag: member="kumonosu::OutgoingClient::run" ref="da2c9009eade4ea095eb4ad7482ee87f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void OutgoingClient::run           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Starts processing of outgoing requests. 
<p>
Initiates a loop that processes all outgoing requests for service ids that have an associated <a class="el" href="classkumonosu_1_1RemoteServer.html" title="Represents a connection to a remote server for sending requests.">RemoteServer</a> and all requests for a service id of 0 (using the supplied server id). The <a class="el" href="classkumonosu_1_1OutgoingClient.html" title="Manages remote server connections and processes sending queueItems.">OutgoingClient</a> does not provide any multi-threading on its own, however, it includes protections that make it thread safe. A mutex is used so that once <a class="el" href="classkumonosu_1_1OutgoingClient.html#da2c9009eade4ea095eb4ad7482ee87f" title="Starts processing of outgoing requests.">run()</a> is called, any subsequent calls have no effect. <a class="el" href="classkumonosu_1_1RequestQueue.html" title="Provides management of std::queue&#39;s for multiple destination services.">RequestQueue</a> notification locks are used for blocking behavior so that the <a class="el" href="classkumonosu_1_1OutgoingClient.html" title="Manages remote server connections and processes sending queueItems.">OutgoingClient</a> doesn't need to use an explicit wait or sleep to prevent spinning. a pthread_mutex_timedlock of 10 seconds is used so that shutdown commands can break the loop from processing. Once started, the <a class="el" href="classkumonosu_1_1OutgoingClient.html" title="Manages remote server connections and processes sending queueItems.">OutgoingClient</a> will run until <a class="el" href="classkumonosu_1_1OutgoingClient.html#1a2d55524e5a5d91aed897a2f315ba2c" title="Stops processing of outgoing requests.">shutdown()</a> is called. 
<p>Definition at line <a class="el" href="OutgoingClient_8cpp-source.html#l00064">64</a> of file <a class="el" href="OutgoingClient_8cpp-source.html">OutgoingClient.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="1a2d55524e5a5d91aed897a2f315ba2c"></a><!-- doxytag: member="kumonosu::OutgoingClient::shutdown" ref="1a2d55524e5a5d91aed897a2f315ba2c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void OutgoingClient::shutdown           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Stops processing of outgoing requests. 
<p>
Sets the flag that indicates that processing should stop. Due to the architecture of the <a class="el" href="classkumonosu_1_1OutgoingClient.html#da2c9009eade4ea095eb4ad7482ee87f" title="Starts processing of outgoing requests.">run()</a> loop, any outstanding requests will be processed prior to shutting down. 
<p>Definition at line <a class="el" href="OutgoingClient_8cpp-source.html#l00109">109</a> of file <a class="el" href="OutgoingClient_8cpp-source.html">OutgoingClient.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="a41f4bc53073db71348badfdf6224b0f"></a><!-- doxytag: member="kumonosu::OutgoingClient::getServerList" ref="a41f4bc53073db71348badfdf6224b0f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; Server &gt; OutgoingClient::getServerList           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td width="100%"></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Returns a list of all servers the client knows about. 
<p>
Returns the list of servers (as Server objects) that the client knows about. The method currently iterates over the list of service ids for each server, so a large number of servers or service ids can impact performance. This should be optimized when it becomes an issue. <dl class="return" compact><dt><b>Returns:</b></dt><dd>list of known servers </dd></dl>

<p>Definition at line <a class="el" href="OutgoingClient_8cpp-source.html#l00115">115</a> of file <a class="el" href="OutgoingClient_8cpp-source.html">OutgoingClient.cpp</a>.</p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="OutgoingClient_8h-source.html">OutgoingClient.h</a><li><a class="el" href="OutgoingClient_8cpp-source.html">OutgoingClient.cpp</a></ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed Sep 9 19:34:38 2009 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.5 </small></address>
</body>
</html>
